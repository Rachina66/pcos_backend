generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
   
}

model User {
  id          String       @id @default(uuid())
  name        String
  email       String       @unique
  password    String
  role        Role         @default(USER)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  predictions Prediction[]  
  appointments Appointment[]                 
}

enum Role {
  USER
  ADMIN
}

model Prediction {
  id               String   @id @default(uuid())
  userId           String                          // String to match User.id (UUID)
  user             User     @relation(fields: [userId], references: [id])

  // Patient inputs 
  age              Float
  weight           Float
  height           Float
  bmi              Float
  bloodGroup       String                          // Stored but NOT used in ML model
  cycleLengthDays  Float
  periodLengthDays Float
  regularOvulation Boolean
  fshLevel         Float
  lhLevel          Float
  androgenLevel    Float
  cystCount        Float
  hirsutism        Boolean
  fastingGlucose   Float
  activityLevel    Int
  stressLevel      Int
  pregnant         Boolean

  // ML Results
  prediction       Int                             // 0 = Low Risk, 1 = High Risk
  probability      Float                           // 0.0 to 1.0
  riskLevel        String                          // "Low Risk" or "High Risk"
  confidence       Float                           // 0.0 to 100.0

  createdAt        DateTime @default(now())

  @@index([userId])
}

//Doctors

model Doctor {
  id             String        @id @default(uuid())
  name           String
  specialization String
  qualification  String
  experience     Int
  hospital       String
  location       String
  phone          String
  email          String        @unique
  bio            String?
  imageUrl       String?
  availableDays  String[]
  timeSlots      String[]
  consultFee     Float
  isActive       Boolean       @default(true)
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  appointments   Appointment[]
}

//Appointment
model Appointment {
  id         String            @id @default(uuid())
  userId     String
  doctorId   String
  user       User              @relation(fields: [userId], references: [id])
  doctor     Doctor            @relation(fields: [doctorId], references: [id])
  date       DateTime
  timeSlot   String
  reason     String?
  reportFile String?           // file path for uploaded report
  status     AppointmentStatus @default(PENDING)
  notes      String?
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt

  @@index([userId])
  @@index([doctorId])
}

enum AppointmentStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

model EducationalContent {
  id          String          @id @default(uuid())
  title       String
  content     String
  category    ContentCategory
  imageUrl    String?
  tags        String[]
  isPublished Boolean         @default(true)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
}

enum ContentCategory {
  PCOS_BASICS
  NUTRITION
  EXERCISE
  MENTAL_HEALTH
  TREATMENT
  LIFESTYLE
}